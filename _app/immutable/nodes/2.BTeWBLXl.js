import{t as I,a as N}from"../chunks/DzXVVYsB.js";import{a6 as P,a4 as ne,p as C,a as W,j as U,az as y,a9 as Y,k as g,o as D,g as l,m as p,s as x,t as $,v as se,i as re,aB as ie}from"../chunks/CISGhN_f.js";import{o as q}from"../chunks/IQUROJPt.js";import{b as R,p as V,_ as oe}from"../chunks/D8FXnjRA.js";import{l as le,s as Z,e as ce}from"../chunks/C1bQEIxT.js";import{e as G,i as K,r as E,a as ue,b as O}from"../chunks/DKwLRlrx.js";function Q(e,t,a){if(e.multiple)return fe(e,t);for(var n of e.options){var s=A(n);if(ne(s,t)){n.selected=!0;return}}(!a||t!==void 0)&&(e.selectedIndex=-1)}function de(e,t){P(()=>{var a=new MutationObserver(()=>{var n=e.__value;Q(e,n)});return a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function pe(e,t,a=t){var n=!0;le(e,"change",s=>{var r=s?"[selected]":":checked",c;if(e.multiple)c=[].map.call(e.querySelectorAll(r),A);else{var u=e.querySelector(r)??e.querySelector("option:not([disabled])");c=u&&A(u)}a(c)}),P(()=>{var s=t();if(Q(e,s,n),n&&s===void 0){var r=e.querySelector(":checked");r!==null&&(s=A(r),a(s))}e.__value=s,n=!1}),de(e)}function fe(e,t){for(var a of e.options)a.selected=~t.indexOf(A(a))}function A(e){return"__value"in e?e.__value:e.value}var ve=I('<div id="map" class="svelte-16jssmr"></div>');function me(e,t){C(t,!0);const a="AIzaSyADPUVze39G8j0r7DaeqhW3fM-f146LcY4";let n,s,r=null;q(async()=>{if(!window.google){const i=document.createElement("script");i.src=`https://maps.googleapis.com/maps/api/js?key=${a}&libraries=places`,i.async=!0,document.head.appendChild(i),await new Promise(o=>i.onload=o)}s=new window.google.maps.Map(n,{center:{lat:34.6545,lng:135.6005},zoom:10})}),W(()=>{c(t.houses)});async function c(i){const o=new window.google.maps.Geocoder;function v(m){return new Promise((d,h)=>{o.geocode({address:m},(_,w)=>{if(w==="OK"&&_&&_[0]){const f=_[0].geometry.location;d(f)}else h("住所の変換に失敗しました")})})}for(const m of i){const d="大阪府"+m.city+m.districtAddress;try{const h=await v(d),_=new window.google.maps.Marker({position:h,map:s,title:d}),w=new window.google.maps.InfoWindow({content:`
            <div style="background: white; color: #1e3a8a; padding: 10px; max-width: 250px; font-family: sans-serif;">
              <h2 style="font-size: 18px; margin-bottom: 8px;">${d}</h2>
              <img src="https://placehold.jp/50x50.png" style="width: 100%; height: auto; margin-bottom: 8px;" />
              <p><strong>価格:</strong> ${m.price}万円</p>
              <p><strong>築年数:</strong> ${m.constructedAt}</p>
              <a href="/#${m.id}" style="background-color: #1e3a8a; color: white; border: none; padding: 8px 12px; border-radius: 5px; margin-top: 10px; cursor: pointer;">
                この空き家を選択する
              </a>
            </div>
          `});_.addListener("click",()=>{r&&r.close(),w.open(s,_),r=w})}catch{console.error(`住所 "${d}" の緯度経度の取得に失敗しました。`)}}}var u=ve();R(u,i=>n=i,()=>n),N(e,u),U()}const B="https://script.google.com/macros/s/AKfycbzNL5fzzAJYj31xq5Coi7GhMqpdLsPCOYHVCbymV4QbuTH1LVEl8erbVQQBvr8k5mpkIg/exec",ge=`${B}?target=houses`,be=`${B}?target=equipments`,xe=()=>fetch(ge).then(e=>e.json()),he=()=>fetch(be).then(e=>e.json());var _e=I('<div class="checkbox-item svelte-1f1jyo3"><label class="svelte-1f1jyo3"><input type="checkbox"> </label></div>'),we=I('<div class="container svelte-1f1jyo3"><div class="category svelte-1f1jyo3"><div class="checkboxes svelte-1f1jyo3"></div></div></div>');function ye(e,t){C(t,!0);const a=[];let n=V(t,"selectedEquipments",15),s=y(Y([]));q(async()=>{D(s,await he(),!0)});var r=we(),c=g(r),u=g(c);G(u,21,()=>l(s),K,(i,o)=>{var v=_e(),m=g(v),d=g(m);E(d);var h,_=x(d);p(m),p(v),$(()=>{h!==(h=l(o))&&(d.value=(d.__value=l(o))??""),Z(_,` ${l(o).name??""}`)}),ue(a,[],d,()=>(l(o),n()),n),N(i,v)}),p(u),p(c),p(r),N(e,r),U()}const J=6e4,X=36e5,F=Symbol.for("constructDateFrom");function H(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&F in e?e[F](t):e instanceof Date?new e.constructor(t):new Date(t)}function S(e,t){return H(e,e)}function ee(e,...t){const a=H.bind(null,t.find(n=>typeof n=="object"));return t.map(a)}function L(e,t){const a=+S(e)-+S(t);return a<0?-1:a>0?1:a}function De(e,t,a){const[n,s]=ee(a==null?void 0:a.in,e,t);return n.getFullYear()-s.getFullYear()}function ke(e,t,a){const[n,s]=ee(a==null?void 0:a.in,e,t),r=L(n,s),c=Math.abs(De(n,s));n.setFullYear(1584),s.setFullYear(1584);const u=L(n,s)===-r,i=r*(c-+u);return i===0?0:i}function Ne(e,t){const a=()=>H(t==null?void 0:t.in,NaN),s=Ye(e);let r;if(s.date){const o=Ce(s.date,2);r=Ue(o.restDateString,o.year)}if(!r||isNaN(+r))return a();const c=+r;let u=0,i;if(s.time&&(u=qe(s.time),isNaN(u)))return a();if(s.timezone){if(i=ze(s.timezone),isNaN(i))return a()}else{const o=new Date(c+u),v=S(0);return v.setFullYear(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()),v.setHours(o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds()),v}return S(c+u+i)}const M={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ie=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Te=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ae=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ye(e){const t={},a=e.split(M.dateTimeDelimiter);let n;if(a.length>2)return t;if(/:/.test(a[0])?n=a[0]:(t.date=a[0],n=a[1],M.timeZoneDelimiter.test(t.date)&&(t.date=e.split(M.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const s=M.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function Ce(e,t){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(a);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,r=n[2]?parseInt(n[2]):null;return{year:r===null?s:r*100,restDateString:e.slice((n[1]||n[2]).length)}}function Ue(e,t){if(t===null)return new Date(NaN);const a=e.match(Ie);if(!a)return new Date(NaN);const n=!!a[4],s=T(a[1]),r=T(a[2])-1,c=T(a[3]),u=T(a[4]),i=T(a[5])-1;if(n)return He(t,u,i)?Me(t,u,i):new Date(NaN);{const o=new Date(0);return!je(t,r,c)||!Ee(t,s)?new Date(NaN):(o.setUTCFullYear(t,r,Math.max(s,c)),o)}}function T(e){return e?parseInt(e):1}function qe(e){const t=e.match(Te);if(!t)return NaN;const a=j(t[1]),n=j(t[2]),s=j(t[3]);return Oe(a,n,s)?a*X+n*J+s*1e3:NaN}function j(e){return e&&parseFloat(e.replace(",","."))||0}function ze(e){if(e==="Z")return 0;const t=e.match(Ae);if(!t)return 0;const a=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return Fe(n,s)?a*(n*X+s*J):NaN}function Me(e,t,a){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,r=(t-1)*7+a+1-s;return n.setUTCDate(n.getUTCDate()+r),n}const Se=[31,null,31,30,31,30,31,31,30,31,30,31];function te(e){return e%400===0||e%4===0&&e%100!==0}function je(e,t,a){return t>=0&&t<=11&&a>=1&&a<=(Se[t]||(te(e)?29:28))}function Ee(e,t){return t>=1&&t<=(te(e)?366:365)}function He(e,t,a){return t>=1&&t<=53&&a>=0&&a<=6}function Oe(e,t,a){return e===24?t===0&&a===0:a>=0&&a<60&&t>=0&&t<60&&e>=0&&e<25}function Fe(e,t){return t>=0&&t<=59}var Le=I("<option> </option>"),Pe=I('<form><label>市区町村: <div class="selectbox-3 svelte-146wpr2"><select multiple class="svelte-146wpr2"></select></div></label> <label style="display: block; margin-bottom: 10px; margin-top: 20px;">価格: <input type="number" class="textbox-1 svelte-146wpr2"></label> <label style="display: block; margin-bottom: 10px;">最大築年数: <input type="number" class="textbox-1 svelte-146wpr2"></label> <div style="margin-top: 20px;"><button type="submit" class="svelte-146wpr2">検索</button></div></form>');function We(e,t){C(t,!0);let a=y(Y([])),n=V(t,"filteredHouses",15);q(async()=>{D(a,await xe(),!0)});let s=y(Y([])),r=y(5e6),c=y(200);function u(){n(l(a).filter(f=>{const b=l(s).length===0||l(s).includes(f.city),k=f.price<=l(r),z=ke(new Date,Ne(f.constructedAt+"-01"))<=l(c);return b&&k&&z}))}var i=Pe(),o=g(i),v=x(g(o)),m=g(v);G(m,21,()=>new Set(l(a).map(f=>f.city)),K,(f,b)=>{var k=Le(),z={},ae=g(k,!0);p(k),$(()=>{z!==(z=l(b))&&(k.value=(k.__value=l(b))??""),Z(ae,l(b))}),N(f,k)}),p(m),p(v),p(o);var d=x(o,2),h=x(g(d));E(h),p(d);var _=x(d,2),w=x(g(_));E(w),p(_),se(2),p(i),ce("submit",i,u),pe(m,()=>l(s),f=>D(s,f)),O(h,()=>l(r),f=>D(r,f)),O(w,()=>l(c),f=>D(c,f)),N(e,i),U()}var $e=I('<div style="width: 100%; height: 400px;"></div>');function Re(e,t){C(t,!0);let a=y(void 0),n;q(async()=>{const r=(await oe(async()=>{const{default:c}=await import("../chunks/CmrCzkCA.js");return{default:c}},[],import.meta.url)).default;D(a,new r(n,{chart:{type:"bar",stacked:!0},plotOptions:{bar:{horizontal:!0}},series:[]}),!0),l(a).render()}),W(()=>{l(a)&&t.data&&l(a).updateOptions({series:t.data,xaxis:{categories:["費用"]}})});var s=$e();R(s,r=>n=r,()=>n),N(e,s),U()}var Ve=I('<div class="text-5xl md:text-7xl font-extrabold text-center py-8 text-shadow"><span class="text-blue-800">A</span><span class="text-black">K</span><span class="text-blue-800">I</span><span class="text-black">Y</span><span class="text-blue-800">A</span> <span class="mx-1"></span> <span class="text-black">S</span><span class="text-blue-800">I</span><span class="text-black">M</span><span class="text-black">U</span><span class="text-black">L</span><span class="text-blue-800">A</span><span class="text-black">T</span><span class="text-blue-800">I</span><span class="text-black">O</span><span class="text-black">N</span></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 px-6 pb-10"><div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Search</div> <!></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Reform</div> <!></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Map</div> <div class="aspect-square rounded-lg overflow-hidden"><!></div></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Dashboard</div> <!></div></div>',1);function Xe(e,t){C(t,!0);let a=y(Y([])),n=y(null),s=y(Y([]));q(()=>{window.addEventListener("hashchange",()=>{D(n,l(a).find(b=>b.id===Number(location.hash.replace("#","")))??null,!0)})});let r=ie(()=>l(n)?[{name:"購入費",data:[l(n).price]},...l(s).map(b=>({name:b.name,data:[b.price]}))]:null);var c=Ve(),u=x(re(c),2),i=g(u),o=x(g(i),2);We(o,{get filteredHouses(){return l(a)},set filteredHouses(b){D(a,b,!0)}}),p(i);var v=x(i,2),m=x(g(v),2);ye(m,{get selectedEquipments(){return l(s)},set selectedEquipments(b){D(s,b,!0)}}),p(v);var d=x(v,2),h=x(g(d),2),_=g(h);me(_,{get houses(){return l(a)}}),p(h),p(d);var w=x(d,2),f=x(g(w),2);Re(f,{get data(){return l(r)}}),p(w),p(u),N(e,c),U()}export{Xe as component};
