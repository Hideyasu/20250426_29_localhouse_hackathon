import{t as D,a as y}from"../chunks/kyvLtmoV.js";import{a4 as E,aB as ae,p as C,a as K,j as M,m as u,k as v,s as g,g as d,t as O,ay as N,ab as F,o as I,v as ne,i as se,aA as re}from"../chunks/CXx8muze.js";import{o as z}from"../chunks/a9oU_d2f.js";import{b as G,p as B,_ as ie}from"../chunks/DXuUuSDu.js";import"../chunks/D6Jt0VtL.js";import{l as oe,s as q,e as le}from"../chunks/DNIaxSd9.js";import{e as W,i as Z,b as R,r as $}from"../chunks/DVnSunxY.js";function V(e,t,a){if(e.multiple)return ue(e,t);for(var n of e.options){var s=A(n);if(ae(s,t)){n.selected=!0;return}}(!a||t!==void 0)&&(e.selectedIndex=-1)}function ce(e,t){E(()=>{var a=new MutationObserver(()=>{var n=e.__value;V(e,n)});return a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function de(e,t,a=t){var n=!0;oe(e,"change",s=>{var r=s?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(r),A);else{var c=e.querySelector(r)??e.querySelector("option:not([disabled])");o=c&&A(c)}a(o)}),E(()=>{var s=t();if(V(e,s,n),n&&s===void 0){var r=e.querySelector(":checked");r!==null&&(s=A(r),a(s))}e.__value=s,n=!1}),ce(e)}function ue(e,t){for(var a of e.options)a.selected=~t.indexOf(A(a))}function A(e){return"__value"in e?e.__value:e.value}var pe=D('<div id="map" class="svelte-16jssmr"></div>');function fe(e,t){C(t,!0);const a="AIzaSyADPUVze39G8j0r7DaeqhW3fM-f146LcY4";let n,s,r=null;z(async()=>{if(!window.google){const i=document.createElement("script");i.src=`https://maps.googleapis.com/maps/api/js?key=${a}&libraries=places`,i.async=!0,document.head.appendChild(i),await new Promise(l=>i.onload=l)}s=new window.google.maps.Map(n,{center:{lat:34.6545,lng:135.6005},zoom:10})}),K(()=>{o(t.houses)});async function o(i){const l=new window.google.maps.Geocoder;function x(m){return new Promise((p,b)=>{l.geocode({address:m},(h,_)=>{if(_==="OK"&&h&&h[0]){const f=h[0].geometry.location;p(f)}else b("住所の変換に失敗しました")})})}for(const m of i){const p="大阪府"+m.city+m.districtAddress;try{const b=await x(p),h=new window.google.maps.Marker({position:b,map:s,title:p}),_=new window.google.maps.InfoWindow({content:`
            <div style="background: white; color: #1e3a8a; padding: 10px; max-width: 250px; font-family: sans-serif;">
              <h2 style="font-size: 18px; margin-bottom: 8px;">${p}</h2>
              <img src="https://placehold.jp/50x50.png" style="width: 100%; height: auto; margin-bottom: 8px;" />
              <p><strong>価格:</strong> ${m.price}万円</p>
              <p><strong>築年数:</strong> ${m.constructedAt}</p>
              <a href="/#${m.id}" style="background-color: #1e3a8a; color: white; border: none; padding: 8px 12px; border-radius: 5px; margin-top: 10px; cursor: pointer;">
                この空き家を選択する
              </a>
            </div>
          `});h.addListener("click",()=>{r&&r.close(),_.open(s,h),r=_})}catch{console.error(`住所 "${p}" の緯度経度の取得に失敗しました。`)}}}var c=pe();G(c,i=>n=i,()=>n),y(e,c),M()}var ve=D('<div class="checkbox-item svelte-18t5lc3"><label class="svelte-18t5lc3"><input type="checkbox"> </label></div>'),me=D('<div class="category svelte-18t5lc3"><div class="category-title svelte-18t5lc3"> </div> <div class="checkboxes svelte-18t5lc3"></div></div>'),ge=D('<div class="container svelte-18t5lc3"></div>');function xe(e,t){let a=B(t,"categories",24,()=>[]);var n=ge();W(n,5,a,Z,(s,r)=>{var o=me(),c=v(o),i=v(c,!0);u(c);var l=g(c,2);W(l,5,()=>d(r).items,Z,(x,m)=>{var p=ve(),b=v(p),h=g(v(b));u(b),u(p),O(()=>q(h,` ${d(m)??""}`)),y(x,p)}),u(l),u(o),O(()=>q(i,d(r).name)),y(s,o)}),u(n),y(e,n)}const be="https://script.google.com/macros/s/AKfycbx1a4sZvZZgHcg9qO1h2cw2nmHpsOmq3nAkZxWd0_FC5eDKB9HUUz6URSNX3pLkYKkq_g/exec?target=houses",he=()=>fetch(be).then(e=>e.json()),J=6e4,X=36e5,j=Symbol.for("constructDateFrom");function P(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&j in e?e[j](t):e instanceof Date?new e.constructor(t):new Date(t)}function S(e,t){return P(e,e)}function Q(e,...t){const a=P.bind(null,t.find(n=>typeof n=="object"));return t.map(a)}function L(e,t){const a=+S(e)-+S(t);return a<0?-1:a>0?1:a}function _e(e,t,a){const[n,s]=Q(a==null?void 0:a.in,e,t);return n.getFullYear()-s.getFullYear()}function we(e,t,a){const[n,s]=Q(a==null?void 0:a.in,e,t),r=L(n,s),o=Math.abs(_e(n,s));n.setFullYear(1584),s.setFullYear(1584);const c=L(n,s)===-r,i=r*(o-+c);return i===0?0:i}function ye(e,t){const a=()=>P(t==null?void 0:t.in,NaN),s=Ie(e);let r;if(s.date){const l=Te(s.date,2);r=Ae(l.restDateString,l.year)}if(!r||isNaN(+r))return a();const o=+r;let c=0,i;if(s.time&&(c=Ue(s.time),isNaN(c)))return a();if(s.timezone){if(i=Ye(s.timezone),isNaN(i))return a()}else{const l=new Date(o+c),x=S(0);return x.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),x.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),x}return S(o+c+i)}const Y={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},De=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ke=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ne=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ie(e){const t={},a=e.split(Y.dateTimeDelimiter);let n;if(a.length>2)return t;if(/:/.test(a[0])?n=a[0]:(t.date=a[0],n=a[1],Y.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Y.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const s=Y.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function Te(e,t){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(a);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,r=n[2]?parseInt(n[2]):null;return{year:r===null?s:r*100,restDateString:e.slice((n[1]||n[2]).length)}}function Ae(e,t){if(t===null)return new Date(NaN);const a=e.match(De);if(!a)return new Date(NaN);const n=!!a[4],s=T(a[1]),r=T(a[2])-1,o=T(a[3]),c=T(a[4]),i=T(a[5])-1;if(n)return He(t,c,i)?Se(t,c,i):new Date(NaN);{const l=new Date(0);return!Me(t,r,o)||!ze(t,s)?new Date(NaN):(l.setUTCFullYear(t,r,Math.max(s,o)),l)}}function T(e){return e?parseInt(e):1}function Ue(e){const t=e.match(ke);if(!t)return NaN;const a=H(t[1]),n=H(t[2]),s=H(t[3]);return Oe(a,n,s)?a*X+n*J+s*1e3:NaN}function H(e){return e&&parseFloat(e.replace(",","."))||0}function Ye(e){if(e==="Z")return 0;const t=e.match(Ne);if(!t)return 0;const a=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return Fe(n,s)?a*(n*X+s*J):NaN}function Se(e,t,a){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,r=(t-1)*7+a+1-s;return n.setUTCDate(n.getUTCDate()+r),n}const Ce=[31,null,31,30,31,30,31,31,30,31,30,31];function ee(e){return e%400===0||e%4===0&&e%100!==0}function Me(e,t,a){return t>=0&&t<=11&&a>=1&&a<=(Ce[t]||(ee(e)?29:28))}function ze(e,t){return t>=1&&t<=(ee(e)?366:365)}function He(e,t,a){return t>=1&&t<=53&&a>=0&&a<=6}function Oe(e,t,a){return e===24?t===0&&a===0:a>=0&&a<60&&t>=0&&t<60&&e>=0&&e<25}function Fe(e,t){return t>=0&&t<=59}var qe=D("<option> </option>"),We=D('<form><label>市区町村: <div class="selectbox-3 svelte-146wpr2"><select multiple class="svelte-146wpr2"></select></div></label> <label style="display: block; margin-bottom: 10px; margin-top: 20px;">価格: <input type="number" class="textbox-1 svelte-146wpr2"></label> <label style="display: block; margin-bottom: 10px;">最大築年数: <input type="number" class="textbox-1 svelte-146wpr2"></label> <div style="margin-top: 20px;"><button type="submit" class="svelte-146wpr2">検索</button></div></form>');function Ze(e,t){C(t,!0);let a=N(F([])),n=B(t,"filteredHouses",15);z(async()=>{I(a,await he(),!0)});let s=N(F([])),r=N(5e6),o=N(200);function c(){n(d(a).filter(f=>{const w=d(s).length===0||d(s).includes(f.city),k=f.price<=d(r),U=we(new Date,ye(f.constructedAt+"-01"))<=d(o);return w&&k&&U}))}var i=We(),l=v(i),x=g(v(l)),m=v(x);W(m,21,()=>new Set(d(a).map(f=>f.city)),Z,(f,w)=>{var k=qe(),U={},te=v(k,!0);u(k),O(()=>{U!==(U=d(w))&&(k.value=(k.__value=d(w))??""),q(te,d(w))}),y(f,k)}),u(m),u(x),u(l);var p=g(l,2),b=g(v(p));$(b),u(p);var h=g(p,2),_=g(v(h));$(_),u(h),ne(2),u(i),le("submit",i,c),de(m,()=>d(s),f=>I(s,f)),R(b,()=>d(r),f=>I(r,f)),R(_,()=>d(o),f=>I(o,f)),y(e,i),M()}var Pe=D('<div style="width: 100%; height: 400px;"></div>');function Re(e,t){C(t,!0);let a=N(void 0),n;z(async()=>{const r=(await ie(async()=>{const{default:o}=await import("../chunks/CmrCzkCA.js");return{default:o}},[],import.meta.url)).default;I(a,new r(n,{chart:{type:"bar",stacked:!0},plotOptions:{bar:{horizontal:!0}},series:[]}),!0),d(a).render()}),K(()=>{d(a)&&t.data&&d(a).updateOptions({series:t.data,xaxis:{categories:["費用"]}})});var s=Pe();G(s,r=>n=r,()=>n),y(e,s),M()}var $e=D('<div class="text-5xl md:text-7xl font-extrabold text-center py-8 text-shadow"><span class="text-blue-800">A</span><span class="text-black">K</span><span class="text-blue-800">I</span><span class="text-black">Y</span><span class="text-blue-800">A</span> <span class="mx-1"></span> <span class="text-black">S</span><span class="text-blue-800">I</span><span class="text-black">M</span><span class="text-black">U</span><span class="text-black">L</span><span class="text-blue-800">A</span><span class="text-black">T</span><span class="text-blue-800">I</span><span class="text-black">O</span><span class="text-black">N</span></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 px-6 pb-10"><div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Search</div> <!></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Reform</div> <!></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Map</div> <div class="aspect-square rounded-lg overflow-hidden"><!></div></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Dashboard</div> <!></div></div>',1);function Je(e,t){C(t,!0);let a=N(F([])),n=N(null);z(()=>{window.addEventListener("hashchange",()=>{I(n,d(a).find(w=>w.id===Number(location.hash.replace("#","")))??null,!0)})});let s=re(()=>d(n)?[{name:"購入費",data:[d(n).price]}]:null);const r=[{name:"水回り",items:["キッチン","風呂","トイレ","洗面所"]},{name:"屋内",items:["リビング","ダイニング","洋室","和室","廊下","階段"]},{name:"屋外",items:["庭","バルコニー","駐車場","外壁","屋根"]},{name:"その他",items:["収納","階段","窓"]}];var o=$e(),c=g(se(o),2),i=v(c),l=g(v(i),2);Ze(l,{get filteredHouses(){return d(a)},set filteredHouses(w){I(a,w,!0)}}),u(i);var x=g(i,2),m=g(v(x),2);xe(m,{categories:r}),u(x);var p=g(x,2),b=g(v(p),2),h=v(b);fe(h,{get houses(){return d(a)}}),u(b),u(p);var _=g(p,2),f=g(v(_),2);Re(f,{get data(){return d(s)}}),u(_),u(c),y(e,o),M()}export{Je as component};
