import{t as Y,a as T}from"../chunks/DzXVVYsB.js";import{a6 as V,a4 as se,p as q,a as Z,j as z,az as y,a9 as U,k as m,o as D,g as i,m as d,s as g,t as L,v as ie,i as oe,aB as le}from"../chunks/CISGhN_f.js";import{l as ce,s as P,e as ue}from"../chunks/C1bQEIxT.js";import{e as G,i as K,r as j,a as de,b as F}from"../chunks/DKwLRlrx.js";import{o as M}from"../chunks/IQUROJPt.js";import{b as Q,p as B,_ as pe}from"../chunks/D8FXnjRA.js";function J(e,t,a){if(e.multiple)return me(e,t);for(var n of e.options){var r=C(n);if(se(r,t)){n.selected=!0;return}}(!a||t!==void 0)&&(e.selectedIndex=-1)}function fe(e,t){V(()=>{var a=new MutationObserver(()=>{var n=e.__value;J(e,n)});return a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function ve(e,t,a=t){var n=!0;ce(e,"change",r=>{var s=r?"[selected]":":checked",c;if(e.multiple)c=[].map.call(e.querySelectorAll(s),C);else{var u=e.querySelector(s)??e.querySelector("option:not([disabled])");c=u&&C(u)}a(c)}),V(()=>{var r=t();if(J(e,r,n),n&&r===void 0){var s=e.querySelector(":checked");s!==null&&(r=C(s),a(r))}e.__value=r,n=!1}),fe(e)}function me(e,t){for(var a of e.options)a.selected=~t.indexOf(C(a))}function C(e){return"__value"in e?e.__value:e.value}var ge=Y('<div id="map" class="svelte-16jssmr"></div>');function be(e,t){q(t,!0);const a="AIzaSyADPUVze39G8j0r7DaeqhW3fM-f146LcY4";let n,r,s=null;M(async()=>{if(!window.google){const l=document.createElement("script");l.src=`https://maps.googleapis.com/maps/api/js?key=${a}&libraries=places`,l.async=!0,document.head.appendChild(l),await new Promise(o=>l.onload=o)}r=new window.google.maps.Map(n,{center:{lat:34.6545,lng:135.6005},zoom:10})}),Z(()=>{c(t.houses)});async function c(l){const o=new window.google.maps.Geocoder;function b(p){return new Promise((f,x)=>{o.geocode({address:p},(h,k)=>{if(k==="OK"&&h&&h[0]){const v=h[0].geometry.location;f(v)}else x("住所の変換に失敗しました")})})}for(const p of l){const f="大阪府"+p.city+p.districtAddress;try{const x=await b(f),h=new window.google.maps.Marker({position:x,map:r,title:f}),k=new window.google.maps.InfoWindow({content:`
            <div style="background: white; color: #1e3a8a; padding: 10px; max-width: 250px; font-family: sans-serif;">
              <h2 style="font-size: 18px; margin-bottom: 8px;">${f}</h2>
              <img src="https://placehold.jp/50x50.png" style="width: 100%; height: auto; margin-bottom: 8px;" />
              <p><strong>価格:</strong> ${p.price}万円</p>
              <p><strong>築年数:</strong> ${p.constructedAt}</p>
              <a href="/#${p.id}" style="background-color: #1e3a8a; color: white; border: none; padding: 8px 12px; border-radius: 5px; margin-top: 10px; cursor: pointer;">
                この空き家を選択する
              </a>
            </div>
          `});h.addListener("click",()=>{s&&s.close(),k.open(r,h),s=k})}catch{console.error(`住所 "${f}" の緯度経度の取得に失敗しました。`)}}}var u=ge();Q(u,l=>n=l,()=>n),T(e,u),z()}const X="https://script.google.com/macros/s/AKfycbzNL5fzzAJYj31xq5Coi7GhMqpdLsPCOYHVCbymV4QbuTH1LVEl8erbVQQBvr8k5mpkIg/exec",xe=`${X}?target=houses`,he=`${X}?target=equipments`,_e=()=>fetch(xe).then(e=>e.json()),we=()=>fetch(he).then(e=>e.json());var ye=Y('<div class="checkbox-item svelte-1f1jyo3"><label class="svelte-1f1jyo3"><input type="checkbox"> </label></div>'),De=Y('<div class="container svelte-1f1jyo3"><div class="category svelte-1f1jyo3"><div class="checkboxes svelte-1f1jyo3"></div></div></div>');function ke(e,t){q(t,!0);const a=[];let n=B(t,"selectedEquipments",15),r=y(U([]));M(async()=>{D(r,await we(),!0)});var s=De(),c=m(s),u=m(c);G(u,21,()=>i(r),K,(l,o)=>{var b=ye(),p=m(b),f=m(p);j(f);var x,h=g(f);d(p),d(b),L(()=>{x!==(x=i(o))&&(f.value=(f.__value=i(o))??""),P(h,` ${i(o).name??""}`)}),de(a,[],f,()=>(i(o),n()),n),T(l,b)}),d(u),d(c),d(s),T(e,s),z()}const ee=6e4,te=36e5,W=Symbol.for("constructDateFrom");function $(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&W in e?e[W](t):e instanceof Date?new e.constructor(t):new Date(t)}function E(e,t){return $(e,e)}function ae(e,...t){const a=$.bind(null,t.find(n=>typeof n=="object"));return t.map(a)}function R(e,t){const a=+E(e)-+E(t);return a<0?-1:a>0?1:a}function Ne(e,t,a){const[n,r]=ae(a==null?void 0:a.in,e,t);return n.getFullYear()-r.getFullYear()}function Ie(e,t,a){const[n,r]=ae(a==null?void 0:a.in,e,t),s=R(n,r),c=Math.abs(Ne(n,r));n.setFullYear(1584),r.setFullYear(1584);const u=R(n,r)===-s,l=s*(c-+u);return l===0?0:l}function Te(e,t){const a=()=>$(t==null?void 0:t.in,NaN),r=Ue(e);let s;if(r.date){const o=qe(r.date,2);s=ze(o.restDateString,o.year)}if(!s||isNaN(+s))return a();const c=+s;let u=0,l;if(r.time&&(u=Me(r.time),isNaN(u)))return a();if(r.timezone){if(l=Se(r.timezone),isNaN(l))return a()}else{const o=new Date(c+u),b=E(0);return b.setFullYear(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()),b.setHours(o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds()),b}return E(c+u+l)}const S={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ye=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ae=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ce=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ue(e){const t={},a=e.split(S.dateTimeDelimiter);let n;if(a.length>2)return t;if(/:/.test(a[0])?n=a[0]:(t.date=a[0],n=a[1],S.timeZoneDelimiter.test(t.date)&&(t.date=e.split(S.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const r=S.timezone.exec(n);r?(t.time=n.replace(r[1],""),t.timezone=r[1]):t.time=n}return t}function qe(e,t){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(a);if(!n)return{year:NaN,restDateString:""};const r=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?r:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function ze(e,t){if(t===null)return new Date(NaN);const a=e.match(Ye);if(!a)return new Date(NaN);const n=!!a[4],r=A(a[1]),s=A(a[2])-1,c=A(a[3]),u=A(a[4]),l=A(a[5])-1;if(n)return Fe(t,u,l)?je(t,u,l):new Date(NaN);{const o=new Date(0);return!He(t,s,c)||!Oe(t,r)?new Date(NaN):(o.setUTCFullYear(t,s,Math.max(r,c)),o)}}function A(e){return e?parseInt(e):1}function Me(e){const t=e.match(Ae);if(!t)return NaN;const a=O(t[1]),n=O(t[2]),r=O(t[3]);return Le(a,n,r)?a*te+n*ee+r*1e3:NaN}function O(e){return e&&parseFloat(e.replace(",","."))||0}function Se(e){if(e==="Z")return 0;const t=e.match(Ce);if(!t)return 0;const a=t[1]==="+"?-1:1,n=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return Pe(n,r)?a*(n*te+r*ee):NaN}function je(e,t,a){const n=new Date(0);n.setUTCFullYear(e,0,4);const r=n.getUTCDay()||7,s=(t-1)*7+a+1-r;return n.setUTCDate(n.getUTCDate()+s),n}const Ee=[31,null,31,30,31,30,31,31,30,31,30,31];function ne(e){return e%400===0||e%4===0&&e%100!==0}function He(e,t,a){return t>=0&&t<=11&&a>=1&&a<=(Ee[t]||(ne(e)?29:28))}function Oe(e,t){return t>=1&&t<=(ne(e)?366:365)}function Fe(e,t,a){return t>=1&&t<=53&&a>=0&&a<=6}function Le(e,t,a){return e===24?t===0&&a===0:a>=0&&a<60&&t>=0&&t<60&&e>=0&&e<25}function Pe(e,t){return t>=0&&t<=59}var $e=Y("<option> </option>"),We=Y('<form><label>市区町村: <div class="selectbox-3 svelte-146wpr2"><select multiple class="svelte-146wpr2"></select></div></label> <label style="display: block; margin-bottom: 10px; margin-top: 20px;">価格: <input type="number" class="textbox-1 svelte-146wpr2"></label> <label style="display: block; margin-bottom: 10px;">最大築年数: <input type="number" class="textbox-1 svelte-146wpr2"></label> <div style="margin-top: 20px;"><button type="submit" class="svelte-146wpr2">検索</button></div></form>');function Re(e,t){q(t,!0);let a=y(U([])),n=B(t,"filteredHouses",15);M(async()=>{D(a,await _e(),!0)});let r=y(U([])),s=y(5e6),c=y(200);function u(){n(i(a).filter(v=>{const N=i(r).length===0||i(r).includes(v.city),_=v.price<=i(s),I=Ie(new Date,Te(v.constructedAt+"-01"))<=i(c);return N&&_&&I}))}var l=We(),o=m(l),b=g(m(o)),p=m(b);G(p,21,()=>new Set(i(a).map(v=>v.city)),K,(v,N)=>{var _=$e(),I={},H=m(_,!0);d(_),L(()=>{I!==(I=i(N))&&(_.value=(_.__value=i(N))??""),P(H,i(N))}),T(v,_)}),d(p),d(b),d(o);var f=g(o,2),x=g(m(f));j(x),d(f);var h=g(f,2),k=g(m(h));j(k),d(h),ie(2),d(l),ue("submit",l,u),ve(p,()=>i(r),v=>D(r,v)),F(x,()=>i(s),v=>D(s,v)),F(k,()=>i(c),v=>D(c,v)),T(e,l),z()}var Ve=Y('<div style="width: 100%; height: 400px;"></div>');function Ze(e,t){q(t,!0);let a=y(void 0),n;M(async()=>{const s=(await pe(async()=>{const{default:c}=await import("../chunks/CmrCzkCA.js");return{default:c}},[],import.meta.url)).default;D(a,new s(n,{chart:{type:"bar",stacked:!0},plotOptions:{bar:{horizontal:!0}},series:[]}),!0),i(a).render()}),Z(()=>{i(a)&&t.data&&i(a).updateOptions({series:t.data,xaxis:{categories:["費用"]}})});var r=Ve();Q(r,s=>n=s,()=>n),T(e,r),z()}var Ge=Y('<div class="text-5xl md:text-7xl font-extrabold text-center py-8 text-shadow"><span class="text-blue-800">A</span><span class="text-black">K</span><span class="text-blue-800">I</span><span class="text-black">Y</span><span class="text-blue-800">A</span> <span class="mx-1"></span> <span class="text-black">S</span><span class="text-blue-800">I</span><span class="text-black">M</span><span class="text-black">U</span><span class="text-black">L</span><span class="text-blue-800">A</span><span class="text-black">T</span><span class="text-blue-800">I</span><span class="text-black">O</span><span class="text-black">N</span></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 px-6 pb-10"><div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Search</div> <!></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Reform</div> <!></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Map</div> <div class="aspect-square rounded-lg overflow-hidden"><!></div></div> <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col"><div class="text-3xl font-bold text-blue-900 mb-4">Dashboard</div> <label>住む年数（年）<input type="range" min="1" max="50"></label> <p> </p> <!></div></div>',1);function tt(e,t){q(t,!0);let a=y(U([])),n=y(null),r=y(U([])),s=y(5);M(()=>{window.addEventListener("hashchange",()=>{D(n,i(a).find(w=>w.id===Number(location.hash.replace("#","")))??null,!0)})});let c=le(()=>i(n)?[{name:"購入費",data:[i(n).price,0]},...i(r).map(w=>({name:w.name,data:[w.price,0]})),{name:"売却予想額",data:[0,i(s)]}]:null);var u=Ge(),l=g(oe(u),2),o=m(l),b=g(m(o),2);Re(b,{get filteredHouses(){return i(a)},set filteredHouses(w){D(a,w,!0)}}),d(o);var p=g(o,2),f=g(m(p),2);ke(f,{get selectedEquipments(){return i(r)},set selectedEquipments(w){D(r,w,!0)}}),d(p);var x=g(p,2),h=g(m(x),2),k=m(h);be(k,{get houses(){return i(a)}}),d(h),d(x);var v=g(x,2),N=g(m(v),2),_=g(m(N));j(_),d(N);var I=g(N,2),H=m(I);d(I);var re=g(I,2);Ze(re,{get data(){return i(c)}}),d(v),d(l),L(()=>P(H,`${i(s)??""} 年`)),F(_,()=>i(s),w=>D(s,w)),T(e,u),z()}export{tt as component};
